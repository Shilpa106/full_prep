-- CREATE TABLE EMPLOYEES(EMPNO INT NOT NULL,ENAME VARCHAR(10),JOB VARCHAR(9),MGR INT,HIREDATE	 	DATE,SAL INT,COMM INT,DEPTNO INT )
-- CREATE TABLE DEPARTMENT (DEPTNO INT, DNAME VARCHAR(14),LOC VARCHAR(13))


-- -- DISPLAY NAME, SAL, JOB OF EMP ALONG WITH MAX, MIN, AVG, TOTAL SAL OF THE EMPS DOING THE SAME JOB.
-- -- DISPLAY DEPTNAME WITH NUMBER OF EMP WORKING IN IT.

/*
1. Using Joins –

Create a sub-table containing the result of aggregated values.
Using Join, use the results from the sub-table to display them with non-aggregated values.


SELECT ENAME,SAL,EMP.JOB,SUBTABLE.MAXSAL,SUBTABLE.MINSAL,SUBTABLE.AVGSAL,SUBTABLE.SUMSAL FROM EMPLOYEES EMP
INNER JOIN 
   (SELECT JOB, MAX(SAL) MAXSAL, MIN(SAL) MINSAL, AVG(SAL) AVGSAL, SUM(SAL) SUMSAL 
     FROM EMPLOYEES GROUP BY JOB ) SUBTABLE 
	    ON EMP.JOB=SUBTABLE.JOB;
*/

/*
2. Using ‘Over’ clause –

1.OVER CLAUSE ALONG WITH PARTITION BY IS USED TO BRAKE UP DATA INTO PARTITIONS.
2.THE SPECIFIED FUNCTION OPERATES FOR EACH PARTITION.

*/
SELECT DISTINCT(DNAME),
COUNT(ENAME) OVER (PARTITION BY EMP.DEPTNO) EMP
FROM EMPLOYEES EMP
RIGHT OUTER JOIN DEPARTMENT DEPT
ON EMP.DEPTNO=DEPT.DEPTNO
ORDER BY EMP DESC; 